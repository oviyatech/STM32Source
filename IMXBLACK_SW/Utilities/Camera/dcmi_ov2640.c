/********************************************************************************
  * @file    DCMI/DCMI_CameraExample/dcmi_ov2640.c
  * @author  MCD Application Team
  * @version V1.3.0
  * @date    13-November-2013
  * @brief   This file includes the driver for OV2640 Camera module mounted on
  *          STM324xG-EVAL and STM32437I-EVAL evaluation boards.
  ******************************************************************************
  * @attention
  *
  * <h2><center>&copy; COPYRIGHT 2013 STMicroelectronics</center></h2>
  *
  * Licensed under MCD-ST Liberty SW License Agreement V2, (the "License");
  * You may not use this file except in compliance with the License.
  * You may obtain a copy of the License at:
  *
  *        http://www.st.com/software_license_agreement_liberty_v2
  *
  * Unless required by applicable law or agreed to in writing, software 
  * distributed under the License is distributed on an "AS IS" BASIS, 
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  *
  ******************************************************************************
  */

/* Includes ------------------------------------------------------------------*/
#include "dcmi_ov2640.h"
#include "stm32f4xx_dcmi.h"
#include "main.h"

/** @addtogroup STM32F4xx_StdPeriph_Examples
  * @{
  */

/** @addtogroup DCMI_Camera
  * @{
  */ 

/*Added by Venkat Start*/
#define OV5640_CONFIGURATION

struct OV5640_REGSETT
{
 uint16_t reg;
 uint8_t val;	
};


/*Added by Venkat end*/
#define  TIMEOUT  2

/* Private macro -------------------------------------------------------------*/
/* Private variables ---------------------------------------------------------*/
/* QQVGA 160x120 */

#ifdef OV5640_CONFIGURATION

static struct OV5640_REGSETT  raw_ov5640_setting_30fps_QVGA_320_240[] = {
	
	{0x3103, 0x11}, {0x3008, 0x82}, {0x3008, 0x42},
	{0x3103, 0x03}, {0x3017, 0xff}, {0x3018, 0xff},
	{0x3034, 0x1a}, {0x3035, 0x11}, {0x3036, 0x46},
	{0x3037, 0x13}, {0x3108, 0x01}, {0x3630, 0x2e},
	{0x3632, 0xe2}, {0x3633, 0x23}, {0x3621, 0xe0},
	{0x3704, 0xa0}, {0x3703, 0x5a}, {0x3715, 0x78},
	{0x3717, 0x01}, {0x370b, 0x60}, {0x3705, 0x1a},
	{0x3905, 0x02}, {0x3906, 0x10}, {0x3901, 0x0a},
	{0x3731, 0x12}, {0x3600, 0x08}, {0x3601, 0x33},
	{0x302d, 0x60}, {0x3620, 0x52}, {0x371b, 0x20},
	{0x471c, 0x50}, {0x3a18, 0x00}, {0x3a19, 0xf8},
	{0x3635, 0x1c}, {0x3634, 0x40}, {0x3622, 0x01},
	{0x3c01, 0x34}, {0x3c04, 0x28}, {0x3c05, 0x98},
	{0x3c06, 0x00}, {0x3c07, 0x08}, {0x3c08, 0x00},
	{0x3c09, 0x1c}, {0x3c0a, 0x9c}, {0x3c0b, 0x40},
	{0x3820, 0x41}, {0x3821, 0x07}, {0x3814, 0x31},
	{0x3815, 0x31}, {0x3800, 0x00}, {0x3801, 0x00},
	{0x3802, 0x00}, {0x3803, 0x04}, {0x3804, 0x0a},
	{0x3805, 0x3f}, {0x3806, 0x07}, {0x3807, 0x9f},
	{0x3808, 0x02}, {0x3809, 0x80}, {0x380a, 0x01},
	{0x380b, 0xe0}, {0x380c, 0x0b}, {0x380d, 0x1c},
	{0x380e, 0x07}, {0x380f, 0xb0}, {0x3810, 0x00},
	{0x3811, 0x10}, {0x3812, 0x00}, {0x3813, 0x06},
	{0x3618, 0x00}, {0x3612, 0x29}, {0x3708, 0x62},
	{0x3709, 0x52}, {0x370c, 0x03}, {0x3a02, 0x03},
	{0x3a03, 0xd8}, {0x3a08, 0x01}, {0x3a09, 0x27},
	{0x3a0a, 0x00}, {0x3a0b, 0xf6}, {0x3a0e, 0x03},
	{0x3a0d, 0x04}, {0x3a14, 0x03}, {0x3a15, 0xd8},
	{0x4001, 0x02}, {0x4004, 0x02}, {0x3000, 0x00},
	{0x3002, 0x1c}, {0x3004, 0xff}, {0x3006, 0xc3},
	{0x300e, 0x58}, {0x302e, 0x00}, {0x4300, 0x30},
	{0x501f, 0x00}, {0x4713, 0x03}, {0x4407, 0x04},
	{0x460b, 0x35}, {0x460c, 0x22}, {0x3824, 0x02},
	{0x5000, 0xa7}, {0x5001, 0xa3}, {0x5180, 0xff},
	{0x5181, 0xf2}, {0x5182, 0x00}, {0x5183, 0x14},
	{0x5184, 0x25}, {0x5185, 0x24}, {0x5186, 0x09},
	{0x5187, 0x09}, {0x5188, 0x09}, {0x5189, 0x75},
	{0x518a, 0x54}, {0x518b, 0xe0}, {0x518c, 0xb2},
	{0x518d, 0x42}, {0x518e, 0x3d}, {0x518f, 0x56},
	{0x5190, 0x46}, {0x5191, 0xf8}, {0x5192, 0x04},
	{0x5193, 0x70}, {0x5194, 0xf0}, {0x5195, 0xf0},
	{0x5196, 0x03}, {0x5197, 0x01}, {0x5198, 0x04},
	{0x5199, 0x12}, {0x519a, 0x04}, {0x519b, 0x00},
	{0x519c, 0x06}, {0x519d, 0x82}, {0x519e, 0x38},
	{0x5380, 0x02}, {0x5381, 0x1c}, {0x5382, 0x5a}, 
  {0x5383, 0x06},{0x5384, 0x0a}, {0x5385, 0x7e},
  {0x5386, 0x88},{0x5387, 0x7c}, {0x5388, 0x6c},
  {0x5389, 0x10},{0x538a, 0x01}, {0x538b, 0x98}, 
  {0x5300, 0x08},{0x5301, 0x30}, {0x5302, 0x10},
  {0x5303, 0x00},{0x5304, 0x08}, {0x5305, 0x30},
  {0x5306, 0x08},{0x5307, 0x16}, {0x5309, 0x08},
  {0x530a, 0x30},{0x530b, 0x04}, {0x530c, 0x06},
  {0x5480, 0x01},{0x5481, 0x08}, {0x5482, 0x14},
  {0x5483, 0x28},{0x5484, 0x51}, {0x5485, 0x65}, 
  {0x5486, 0x71},{0x5487, 0x7d}, {0x5488, 0x87},
  {0x5489, 0x91},{0x548a, 0x9a}, {0x548b, 0xaa},
  {0x548c, 0xb8},{0x548d, 0xcd}, {0x548e, 0xdd},
  {0x548f, 0xea},{0x5490, 0x1d}, {0x5580, 0x02}, 
  {0x5583, 0x40},{0x5584, 0x10}, {0x5589, 0x10},
  {0x558a, 0x00},{0x558b, 0xf8}, {0x5800, 0x23},
  {0x5801, 0x15},{0x5802, 0x10}, {0x5803, 0x10},
 {0x5804, 0x15},{0x5805, 0x23}, {0x5806, 0x0c},
 {0x5807, 0x08},{0x5808, 0x05}, {0x5809, 0x05},
 {0x580a, 0x08},{0x580b, 0x0c}, {0x580c, 0x07},
 {0x580d, 0x03},{0x580e, 0x00}, {0x580f, 0x00}, 
 {0x5810, 0x03},{0x5811, 0x07}, {0x5812, 0x07},
 {0x5813, 0x03},{0x5814, 0x00}, {0x5815, 0x00},
 {0x5816, 0x03},{0x5817, 0x07}, {0x5818, 0x0b},
 {0x5819, 0x08},{0x581a, 0x05}, {0x581b, 0x05},
 {0x581c, 0x07},	{0x581d, 0x0b}, {0x581e, 0x2a},
 {0x581f, 0x16},{0x5820, 0x11}, {0x5821, 0x11},
 {0x5822, 0x15},{0x5823, 0x29}, {0x5824, 0xbf},
 {0x5825, 0xaf},{0x5826, 0x9f}, {0x5827, 0xaf},
 {0x5828, 0xdf},{0x5829, 0x6f}, {0x582a, 0x8e},
 {0x582b, 0xab},{0x582c, 0x9e}, {0x582d, 0x7f},
 {0x582e, 0x4f},{0x582f, 0x89}, {0x5830, 0x86},
 {0x5831, 0x98},{0x5832, 0x6f}, {0x5833, 0x4f},
 {0x5834, 0x6e},{0x5835, 0x7b}, {0x5836, 0x7e},
 {0x5837, 0x6f},{0x5838, 0xde}, {0x5839, 0xbf},
 {0x583a, 0x9f},{0x583b, 0xbf}, {0x583c, 0xec},
 {0x5025, 0x00},{0x3a0f, 0x30}, {0x3a10, 0x28},
 {0x3a1b, 0x30},{0x3a1e, 0x26}, {0x3a11, 0x60},
 {0x3a1f, 0x14},{0x3008, 0x02}, {0x3035, 0x11},
 {0x3808, 0x01},{0x3809, 0x40}, {0x380a, 0x00},
 {0x380b, 0xf0},
};


//RAW 640x480
static struct OV5640_REGSETT  raw_ov6540_setting_30fps_VGA_640_480[]={

	{0x3103, 0x11}, {0x3008, 0x82}, {0x3008, 0x42},
	{0x3103, 0x03}, {0x3017, 0x7f}, {0x3018, 0xfc},
#if 1
	/* enable color bar */
	{0x503d, 0x00},/*oviya*/ 
#endif
	{0x3034, 0x18}, {0x3035, 0x11}, {0x3036, 0x48},
	{0x3037, 0x13}, {0x303d, 0x32}, {0x3108, 0x01}, 
  {0x3630, 0x2e},{0x3632, 0xe2}, {0x3633, 0x23}, 
  {0x3621, 0xe0},{0x3704, 0xa0}, {0x3703, 0x5a}, 
  {0x3715, 0x78},{0x3717, 0x01}, {0x370b, 0x60}, 
  {0x3705, 0x1a},{0x3905, 0x02}, {0x3906, 0x10}, 
  {0x3901, 0x0a},{0x3731, 0x12}, {0x3600, 0x08}, 
  {0x3601, 0x33},{0x302d, 0x60}, {0x3620, 0x52}, 
  {0x371b, 0x20},{0x471c, 0x50}, {0x3a18, 0x00},
  {0x3a19, 0xf8},{0x3635, 0x1c}, {0x3634, 0x40},
  {0x3622, 0x01},{0x3c01, 0x34}, {0x3c04, 0x28}, 
  {0x3c05, 0x98},{0x3c06, 0x00}, {0x3c07, 0x08}, 
  {0x3c08, 0x00},{0x3c09, 0x1c}, {0x3c0a, 0x9c}, 
  {0x3c0b, 0x40},{0x3820, 0x41}, {0x3821, 0x07},
  {0x3814, 0x31},{0x3815, 0x31}, {0x3800, 0x00}, 
  {0x3801, 0x00},{0x3802, 0x00}, {0x3803, 0x04}, 
  {0x3804, 0x0a},{0x3805, 0x3f}, {0x3806, 0x07},
  {0x3807, 0x9f},{0x3808, 0x02}, {0x3809, 0x80},
  {0x380a, 0x01},{0x380b, 0xe0}, {0x380c, 0x0b}, 
  {0x380d, 0x1c},{0x380e, 0x07}, {0x380f, 0xb0},
  {0x3810, 0x00},{0x3811, 0x10}, {0x3812, 0x00},
  {0x3813, 0x06},	{0x3811, 0x10}, {0x3812, 0x00},
  {0x3813, 0x06},{0x3814, 0x11}, {0x3815, 0x11},
  {0x3618, 0x00}, {0x3612, 0x29}, {0x3708, 0x62},
  {0x3709, 0x52}, {0x370c, 0x03}, {0x3a02, 0x03},
  {0x3a03, 0xd8}, {0x3a08, 0x01}, {0x3a09, 0x27},
  {0x3a0a, 0x00}, {0x3a0b, 0xf6}, {0x3a0e, 0x03},
  {0x3a0d, 0x04},{0x3a14, 0x03}, {0x3a15, 0xd8},
  {0x4000, 0x01},{0x4001, 0x02}, {0x4004, 0x02},
  {0x3000, 0x00},{0x3002, 0x1c}, {0x3004, 0xff},
  {0x3006, 0xc3},{0x300e, 0x58}, {0x302e, 0x00},
  {0x4300, 0x30},{0x501f, 0x00}, {0x5027, 0x01},
  {0x5028, 0x04},{0x5029, 0x90},{0x502a, 0x05},
  {0x502b, 0x90},{0x502c, 0x03}, {0x4713, 0x03},
  {0x4407, 0x04},{0x502d, 0x6c}, {0x502e, 0x04},
  {0x502f, 0x2c},  {0x5034, 0x80}, {0x5035, 0x2a}, 
  {0x5036, 0x14}, {0x460b, 0x35}, {0x460c, 0x22},
  {0x3824, 0x02},{0x5000, 0xa7}, {0x5001, 0x23},
  {0x5005, 0x36}, {0x5180, 0xff},{0x5181, 0xf2}, 
  {0x5182, 0x00},{0x5183, 0x90},{0x5184, 0x25},
  {0x5185, 0x24}, {0x5186, 0x09},{0x5187, 0x09}, 
  {0x5188, 0x09}, {0x5189, 0x75},{0x518a, 0x54},
  {0x518b, 0xe0}, {0x518c, 0xb2},{0x518d, 0x42}, 
  {0x518e, 0x3d}, {0x518f, 0x56},{0x5190, 0x46},
  {0x5191, 0xf8}, {0x5192, 0x04},{0x5381, 0x1c}, 
  {0x5382, 0x5a}, {0x5383, 0x06},{0x5384, 0x0a},
  {0x5385, 0x7e}, {0x5386, 0x88},{0x5387, 0x7c}, 
  {0x5388, 0x6c}, {0x5389, 0x10},{0x538a, 0x01},
  {0x538b, 0x98}, {0x5300, 0x08},{0x5301, 0x30},
  {0x5302, 0x10}, {0x5303, 0x00},{0x5304, 0x08}, 
  {0x5305, 0x30}, {0x5306, 0x08},{0x5307, 0x16},
  {0x5309, 0x08}, {0x530a, 0x30},{0x530b, 0x04},
  {0x530c, 0x06}, {0x5480, 0x01},{0x5481, 0x08}, 
  {0x5482, 0x14}, {0x5483, 0x28},{0x5484, 0x51},
  {0x5485, 0x65}, {0x5486, 0x71},{0x5487, 0x7d},
  {0x5488, 0x87}, {0x5489, 0x91},{0x548a, 0x9a},
  {0x548b, 0xaa}, {0x548c, 0xb8},{0x548d, 0xcd},
  {0x548e, 0xdd}, {0x548f, 0xea},{0x5490, 0x1d},
  {0x5580, 0x02}, {0x5583, 0x40},{0x5584, 0x10},
  {0x5589, 0x10}, {0x558a, 0x00},	{0x558b, 0xf8},
  {0x5800, 0x23}, {0x5801, 0x15},{0x5802, 0x10},
  {0x5803, 0x10}, {0x5804, 0x15},{0x5805, 0x23},
  {0x5806, 0x0c}, {0x5807, 0x08},{0x5808, 0x05},
  {0x5809, 0x05}, {0x580a, 0x08},{0x580b, 0x0c},
  {0x580c, 0x07}, {0x580d, 0x03},{0x580e, 0x00},
  {0x580f, 0x00}, {0x5810, 0x03},{0x5811, 0x07},
  {0x5812, 0x07}, {0x5813, 0x03},{0x5814, 0x00},
  {0x5815, 0x00}, {0x5816, 0x03},{0x5817, 0x07},
  {0x5818, 0x0b}, {0x5819, 0x08},{0x581a, 0x05},
  {0x581b, 0x05}, {0x581c, 0x07},{0x581d, 0x0b},
  {0x581e, 0x2a}, {0x581f, 0x16},{0x5820, 0x11},
  {0x5821, 0x11}, {0x5822, 0x15},{0x5823, 0x29},
  {0x5824, 0xbf}, {0x5825, 0xaf},{0x5826, 0x9f},
  {0x5827, 0xaf}, {0x5828, 0xdf},{0x5829, 0x6f},
  {0x582a, 0x8e}, {0x582b, 0xab},{0x582c, 0x9e},
  {0x582d, 0x7f}, {0x582e, 0x4f},{0x582f, 0x89},
  {0x5830, 0x86}, {0x5831, 0x98},	{0x5832, 0x6f},
  {0x5833, 0x4f}, {0x5834, 0x6e},{0x5835, 0x7b},
  {0x5836, 0x7e}, {0x5837, 0x6f},{0x5838, 0xde},
  {0x5839, 0xbf}, {0x583a, 0x9f},{0x583b, 0xbf},
  {0x583c, 0xec}, {0x5025, 0x00},{0x3a0f, 0x30}, 
  {0x3a10, 0x28}, {0x3a1b, 0x30},{0x3a1e, 0x26},
  {0x3a11, 0x60}, {0x3a1f, 0x14},{0x3008, 0x02},
  {0x3035, 0x21}, {0x4741, 0x01},


};

//RAW 720P
	static struct OV5640_REGSETT  raw_ov5640_setting_30fps_720P_1280_720[]={
	
	{ 0x3103, 0x11},{ 0x3008, 0x82},{ 0x3008, 0x42},
	{ 0x3103, 0x03},{ 0x3017, 0xff},{ 0x3018, 0xff},
	{ 0x3034, 0x1a},{ 0x3035, 0x11},{ 0x3036, 0x69},
	{ 0x3037, 0x14},{ 0x3108, 0x01},{ 0x3630, 0x36},
	{ 0x3631, 0x0e},{ 0x3632, 0xe2},{ 0x3633, 0x12},
	{ 0x3621, 0xe0},{ 0x3704, 0xa0},{ 0x3703, 0x5a},
	{ 0x3715, 0x78},{ 0x3717, 0x01},{ 0x370b, 0x60},
  { 0x3705, 0x1a},{ 0x3905, 0x02},{ 0x3906, 0x10},
	{ 0x3901, 0x0a},{ 0x3731, 0x12},{ 0x3600, 0x08},
	{ 0x3601, 0x33},{ 0x302d, 0x60},{ 0x3620, 0x52},
	{ 0x371b, 0x20},{ 0x471c, 0x50},{ 0x3a13, 0x43},
	{ 0x3a18, 0x00},{ 0x3a19, 0xf8},{ 0x3635, 0x13},
	{ 0x3636, 0x03},{ 0x3634, 0x40},{ 0x3622, 0x01},
	{ 0x3c01, 0x34},{ 0x3c04, 0x28},{ 0x3c05, 0x98},
	{ 0x3c06, 0x00},{ 0x3c07, 0x07},{ 0x3c08, 0x00},
	{ 0x3c09, 0x1c},{ 0x3c0a, 0x9c},{ 0x3c0b, 0x40},
	{ 0x3820, 0x41},{ 0x3821, 0x27},{ 0x3814, 0x31},
	{ 0x3815, 0x31},{ 0x3800, 0x00},{ 0x3801, 0x00},
	{ 0x3802, 0x00},{ 0x3803, 0xfa},{ 0x3804, 0x0a},
	{ 0x3805, 0x3f},{ 0x3806, 0x06},{ 0x3807, 0xa9},
	{ 0x3808, 0x05},{ 0x3809, 0x00},{ 0x380a, 0x02},
	{ 0x380b, 0xd0},{ 0x380c, 0x07},{ 0x380d, 0x64},
	{ 0x380e, 0x02},{ 0x380f, 0xe4},{ 0x3810, 0x00},
	{ 0x3811, 0x10},{ 0x3812, 0x00},{ 0x3813, 0x04},
	{ 0x3618, 0x00},{ 0x3612, 0x29},{ 0x3708, 0x62},
	{ 0x3709, 0x52},{ 0x370c, 0x03},{ 0x3a02, 0x02},
	{ 0x3a03, 0xe4},{ 0x3a08, 0x01},{ 0x3a09, 0xbc},
	{ 0x3a0a, 0x01},{ 0x3a0b, 0x72},{ 0x3a0e, 0x01},
	{ 0x3a0d, 0x02},{ 0x3a14, 0x02},{ 0x3a15, 0xe4},
	{ 0x4001, 0x02},{ 0x4004, 0x02},{ 0x3000, 0x00},
	{ 0x3002, 0x00},{ 0x3004, 0xff},{ 0x3006, 0xff},
  { 0x300e, 0x58},{ 0x302e, 0x00},{ 0x4300, 0x30},
	{ 0x501f, 0x00},{ 0x4713, 0x02},
	#if 0
	{ 0x4400, 0x81},{ 0x4402, 0x10},{ 0x4408, 0x00}, //OVIYA
	#endif
	{ 0x4407, 0x04},{ 0x440e, 0x00},{ 0x460b, 0x35},
	{ 0x460c, 0x22},{ 0x4827, 0x16},{ 0x3824, 0x04},
	{ 0x5000, 0xa7},{ 0x5001, 0x83},{ 0x5180, 0xff},
	{ 0x5181, 0xf2},{ 0x5182, 0x00},{ 0x5183, 0x14},
	{ 0x5184, 0x25},{ 0x5185, 0x24},{ 0x5186, 0x09},
	{ 0x5187, 0x09},{ 0x5188, 0x09},{ 0x5189, 0x75},
	{ 0x518a, 0x54},{ 0x518b, 0xe0},{ 0x518c, 0xb2},
	{ 0x518d, 0x42},{ 0x518e, 0x3d},{ 0x518f, 0x56},
	{ 0x5190, 0x46},{ 0x5191, 0xf8},{ 0x5192, 0x04},
	{ 0x5193, 0x70},{ 0x5194, 0xf0},{ 0x5195, 0xf0},
	{ 0x5196, 0x03},{ 0x5197, 0x01},{ 0x5198, 0x04},
	{ 0x5199, 0x12},{ 0x519a, 0x04},{ 0x519b, 0x00},
	{ 0x519c, 0x06},{ 0x519d, 0x82},{ 0x519e, 0x38},
	{ 0x5381, 0x1e},{ 0x5380, 0x02},{ 0x5382, 0x5b},
	{ 0x5383, 0x08},{ 0x5384, 0x0a},{ 0x5385, 0x7e},
	{ 0x5386, 0x88},{ 0x5387, 0x7c},{ 0x5388, 0x6c},
	{ 0x5389, 0x10},{ 0x538a, 0x01},{ 0x538b, 0x98},
	{ 0x5300, 0x08},{ 0x5301, 0x30},{ 0x5302, 0x10},
	{ 0x5303, 0x00},{ 0x5304, 0x08},{ 0x5305, 0x30},
	{ 0x5306, 0x08},{ 0x5307, 0x16},{ 0x5309, 0x08},
	{ 0x530a, 0x30},{ 0x530b, 0x04},{ 0x530c, 0x06},
	{ 0x5480, 0x01},{ 0x5481, 0x08},{ 0x5482, 0x14},
	{ 0x5483, 0x28},{ 0x5484, 0x51},{ 0x5485, 0x65},
	{ 0x5486, 0x71},{ 0x5487, 0x7d},{ 0x5488, 0x87},
	{ 0x5489, 0x91},{ 0x548a, 0x9a},{ 0x548b, 0xaa},
	{ 0x548c, 0xb8},{ 0x548d, 0xcd},{ 0x548e, 0xdd},
	{ 0x548f, 0xea},{ 0x5490, 0x1d},{ 0x5580, 0x02},
	{ 0x5583, 0x40},{ 0x5584, 0x10},{ 0x5589, 0x10},
	{ 0x558a, 0x00},{ 0x558b, 0xf8},{ 0x5800, 0x23},
	{ 0x5801, 0x14},{ 0x5802, 0x0f},{ 0x5803, 0x0f},
	{ 0x5804, 0x12},{ 0x5805, 0x26},{ 0x5806, 0x0c},
	{ 0x5807, 0x08},{ 0x5808, 0x05},{ 0x5809, 0x05},
	{ 0x580a, 0x08},{ 0x580b, 0x0d},{ 0x580c, 0x08},
	{ 0x580d, 0x03},{ 0x580e, 0x00},{ 0x580f, 0x00},
	{ 0x5810, 0x03},{ 0x5811, 0x09},{ 0x5812, 0x07},
	{ 0x5813, 0x03},{ 0x5814, 0x00},{ 0x5815, 0x01},
	{ 0x5816, 0x03},{ 0x5817, 0x08},{ 0x5818, 0x0d},
	{ 0x5819, 0x08},{ 0x581a, 0x05},{ 0x581b, 0x06},
	{ 0x581c, 0x08},{ 0x581d, 0x0e},{ 0x581e, 0x29},
	{ 0x581f, 0x17},{ 0x5820, 0x11},{ 0x5821, 0x11},
	{ 0x5822, 0x15},{ 0x5823, 0x28},{ 0x5824, 0x46},
	{ 0x5825, 0x26},{ 0x5826, 0x08},{ 0x5827, 0x26},
	{ 0x5828, 0x64},{ 0x5829, 0x26},{ 0x582a, 0x24},
	{ 0x582b, 0x22},{ 0x582c, 0x24},{ 0x582d, 0x24},
	{ 0x582e, 0x06},{ 0x582f, 0x22},{ 0x5830, 0x40},
	{ 0x5831, 0x42},{ 0x5832, 0x24},{ 0x5833, 0x26},
  { 0x5834, 0x24},{ 0x5835, 0x22},{ 0x5836, 0x22},
	{ 0x5837, 0x26},{ 0x5838, 0x44},{ 0x5839, 0x24},
	{ 0x583a, 0x26},{ 0x583b, 0x28},{ 0x583c, 0x42},
	{ 0x583d, 0xce},{ 0x5025, 0x00},{ 0x3a0f, 0x30},
	{ 0x3a10, 0x28},{ 0x3a1b, 0x30},{ 0x3a1e, 0x26},
	{ 0x3a11, 0x60},{ 0x3a1f, 0x14},{ 0x3008, 0x02},
	{ 0x3035, 0x21},{ 0x4602, 0x05},{ 0x4603, 0x00},
  { 0x4604, 0x04},{ 0x4605, 0x38},     
	
};


//RAW 1080P
static struct OV5640_REGSETT  raw_ov5640_setting_15fps_1080P_1920_1080[]={
{ 0x3103, 0x11},{ 0x3008, 0x82},{ 0x3008, 0x42},
{ 0x3103, 0x03},{ 0x3017, 0xff},{ 0x3018, 0xff},
{ 0x3034, 0x1a},{ 0x3035, 0x11},{ 0x3036, 0x69},
{ 0x3037, 0x13},{ 0x3108, 0x01},{ 0x3630, 0x36},
{ 0x3631, 0x0e},{ 0x3632, 0xe2},{ 0x3633, 0x12},
{ 0x3621, 0xe0},{ 0x3704, 0xa0},{ 0x3703, 0x5a},
{ 0x3715, 0x78},{ 0x3717, 0x01},{ 0x370b, 0x60},
{ 0x3705, 0x1a},{ 0x3905, 0x02},{ 0x3906, 0x10},
{ 0x3901, 0x0a},{ 0x3731, 0x12},{ 0x3600, 0x08},
{ 0x3601, 0x33},{ 0x302d, 0x60},{ 0x3620, 0x52},
{ 0x371b, 0x20},{ 0x471c, 0x50},{ 0x3a13, 0x43},
{ 0x3a18, 0x00},{ 0x3a19, 0xf8},{ 0x3635, 0x13},
{ 0x3636, 0x03},{ 0x3634, 0x40},{ 0x3622, 0x01},
{ 0x3c01, 0x34},{ 0x3c04, 0x28},{ 0x3c05, 0x98},
{ 0x3c06, 0x00},{ 0x3c07, 0x07},{ 0x3c08, 0x00},
{ 0x3c09, 0x1c},{ 0x3c0a, 0x9c},{ 0x3c0b, 0x40},
{ 0x3820, 0x41},{ 0x3821, 0x26},{ 0x3814, 0x11},
{ 0x3815, 0x11},{ 0x3800, 0x01},{ 0x3801, 0x50},
{ 0x3802, 0x01},{ 0x3803, 0xb2},{ 0x3804, 0x08},
{ 0x3805, 0xef},{ 0x3806, 0x05},{ 0x3807, 0xf2},
{ 0x3808, 0x07},{ 0x3809, 0x80},{ 0x380a, 0x04},
{ 0x380b, 0x38},{ 0x380c, 0x09},{ 0x380d, 0xc4},
{ 0x380e, 0x04},{ 0x380f, 0x60},{ 0x3810, 0x00},
{ 0x3811, 0x10},{ 0x3812, 0x00},{ 0x3813, 0x04},
{ 0x3618, 0x04},{ 0x3612, 0x2b},{ 0x3708, 0x62},
{ 0x3709, 0x12},{ 0x370c, 0x00},{ 0x3a02, 0x04},
{ 0x3a03, 0x60},{ 0x3a08, 0x01},{ 0x3a09, 0x50},
{ 0x3a0a, 0x01},{ 0x3a0b, 0x18},{ 0x3a0e, 0x03},
{ 0x3a0d, 0x04},{ 0x3a14, 0x04},{ 0x3a15, 0x60},
{ 0x4001, 0x02},{ 0x4004, 0x06},{ 0x3000, 0x00},
{ 0x3002, 0x00},{ 0x3004, 0xff},{ 0x3006, 0xff},
{ 0x300e, 0x58},{ 0x302e, 0x00},{ 0x4300, 0x30},
{ 0x501f, 0x00},{ 0x4713, 0x02},{ 0x4407, 0x04},
{ 0x440e, 0x00},{ 0x460b, 0x35},{ 0x460c, 0x22},
{ 0x4827, 0x16},{ 0x4827, 0x16},{ 0x3824, 0x04},
{ 0x5000, 0xa7},{ 0x5001, 0x83},{ 0x5180, 0xff},
{ 0x5181, 0xf2},{ 0x5182, 0x00},{ 0x5183, 0x14},
{ 0x5184, 0x25},{ 0x5185, 0x24},{ 0x5186, 0x09},
{ 0x5187, 0x09},{ 0x5188, 0x09},{ 0x5189, 0x75},
{ 0x518a, 0x54},{ 0x518b, 0xe0},{ 0x518c, 0xb2},
{ 0x518d, 0x42},{ 0x518e, 0x3d},{ 0x518f, 0x56},
{ 0x5190, 0x46},{ 0x5191, 0xf8},{ 0x5192, 0x04},
{ 0x5193, 0x70},{ 0x5194, 0xf0},{ 0x5195, 0xf0},
{ 0x5196, 0x03},{ 0x5197, 0x01},{ 0x5198, 0x04},
{ 0x5199, 0x12},{ 0x519a, 0x04},{ 0x519b, 0x00},
{ 0x519c, 0x06},{ 0x519d, 0x82},{ 0x519e, 0x38},
{ 0x5381, 0x1e},{ 0x5380, 0x02},{ 0x5382, 0x5b},
{ 0x5383, 0x08},{ 0x5384, 0x0a},{ 0x5385, 0x7e},
{ 0x5386, 0x88},{ 0x5387, 0x7c},{ 0x5388, 0x6c},
{ 0x5389, 0x10},{ 0x538a, 0x01},{ 0x538b, 0x98},
{ 0x5300, 0x08},{ 0x5301, 0x30},{ 0x5302, 0x10},
{ 0x5303, 0x00},{ 0x5304, 0x08},{ 0x5305, 0x30},
{ 0x5306, 0x08},{ 0x5307, 0x16},{ 0x5309, 0x08},
{ 0x530a, 0x30},{ 0x530b, 0x04},{ 0x530c, 0x06},
{ 0x5480, 0x01},{ 0x5481, 0x08},{ 0x5482, 0x14},
{ 0x5483, 0x28},{ 0x5484, 0x51},{ 0x5485, 0x65},
{ 0x5486, 0x71},{ 0x5487, 0x7d},{ 0x5488, 0x87},
{ 0x5489, 0x91},{ 0x548a, 0x9a},{ 0x548b, 0xaa},
{ 0x548c, 0xb8},{ 0x548d, 0xcd},{ 0x548e, 0xdd},
{ 0x548f, 0xea},{ 0x5490, 0x1d},{ 0x5580, 0x02},
{ 0x5583, 0x40},{ 0x5584, 0x10},{ 0x5589, 0x10},
{ 0x558a, 0x00},{ 0x558b, 0xf8},{ 0x5800, 0x23},
{ 0x5801, 0x14},{ 0x5802, 0x0f},{ 0x5803, 0x0f},
{ 0x5804, 0x12},{ 0x5805, 0x26},{ 0x5806, 0x0c},
{ 0x5807, 0x08},{ 0x5808, 0x05},{ 0x5809, 0x05},
{ 0x580a, 0x08},{ 0x580b, 0x0d},{ 0x580c, 0x08},
{ 0x580d, 0x03},{ 0x580e, 0x00},{ 0x580f, 0x00},
{ 0x5810, 0x03},{ 0x5811, 0x09},{ 0x5812, 0x07},
{ 0x5813, 0x03},{ 0x5814, 0x00},{ 0x5815, 0x01},
{ 0x5816, 0x03},{ 0x5817, 0x08},{ 0x5818, 0x0d},
{ 0x5819, 0x08},{ 0x581a, 0x05},{ 0x581b, 0x06},
{ 0x581c, 0x08},{ 0x581d, 0x0e},{ 0x581e, 0x29},
{ 0x581f, 0x17},{ 0x5820, 0x11},{ 0x5821, 0x11},
{ 0x5822, 0x15},{ 0x5823, 0x28},{ 0x5824, 0x46},
{ 0x5825, 0x26},{ 0x5826, 0x08},{ 0x5827, 0x26},
{ 0x5828, 0x64},{ 0x5829, 0x26},{ 0x582a, 0x24},
{ 0x582b, 0x22},{ 0x582c, 0x24},{ 0x582d, 0x24},
{ 0x582e, 0x06},{ 0x582f, 0x22},{ 0x5830, 0x40},
{ 0x5831, 0x42},{ 0x5832, 0x24},{ 0x5833, 0x26},
{ 0x5834, 0x24},{ 0x5835, 0x22},{ 0x5836, 0x22},
{ 0x5837, 0x26},{ 0x5838, 0x44},{ 0x5839, 0x24},
{ 0x583a, 0x26},{ 0x583b, 0x28},{ 0x583c, 0x42},
{ 0x583d, 0xce},{ 0x5025, 0x00},{ 0x3a0f, 0x30},
{ 0x3a10, 0x28},{ 0x3a1b, 0x30},{ 0x3a1e, 0x26},
{ 0x3a11, 0x60},{ 0x3a1f, 0x14},{ 0x3008, 0x02},
{ 0x3035, 0x21},{ 0x4602, 0x05},{ 0x4603, 0x00},
{ 0x4604, 0x04},{ 0x4605, 0x38},      
};


//RAW 2592x1944 5 MP
static struct OV5640_REGSETT  raw_ov5640_setting_15fps_QSXGA_2592_1944[]={
	{0x3705, 0x1a},{0x3905, 0x02},{0x3906, 0x10},
	{0x3901, 0x0a},{0x3731, 0x12},{0x3600, 0x08},
	{0x3601, 0x33},{0x302d, 0x60},{0x3620, 0x52},
	{0x371b, 0x20},{0x471c, 0x50},{0x3a13, 0x43},
	{0x3a18, 0x00},{0x3a19, 0xf8},{0x3635, 0x13},
	{0x3636, 0x03},{0x3634, 0x40},{0x3622, 0x01},
	{0x3c01, 0x34},{0x3c04, 0x28},{0x3c05, 0x98},
	{0x3c06, 0x00},{0x3c07, 0x07},{0x3c08, 0x00},
	{0x3c09, 0x1c},{0x3c0a, 0x9c},{0x3c0b, 0x40},
	{0x3820, 0x41},{0x3821, 0x26},{0x3814, 0x11},
	{0x3815, 0x11},{0x3800, 0x00},{0x3801, 0x00},
	{0x3802, 0x00},{0x3803, 0x00},{0x3804, 0x0a},
	{0x3805, 0x3f},{0x3806, 0x07},{0x3807, 0x9f},
	{0x3808, 0x0a},{0x3809, 0x20},{0x380a, 0x07},
	{0x380b, 0x98},{0x380c, 0x0b},{0x380d, 0x1c},
	{0x380e, 0x07},{0x380f, 0xb0},{0x3810, 0x00},
	{0x3811, 0x10},{0x3812, 0x00},{0x3813, 0x04},
	{0x3618, 0x04},{0x3612, 0x2b},{0x3708, 0x64},
	{0x3709, 0x12},{0x370c, 0x00},{0x3a02, 0x07},
	{0x3a03, 0xb0},{0x3a08, 0x01},{0x3a09, 0x27},
	{0x3a0a, 0x00},{0x3a0b, 0xf6},{0x3a0e, 0x06},
	{0x3a0d, 0x08},{0x3a14, 0x07},{0x3a15, 0xb0},
	{0x4001, 0x02},{0x4004, 0x06},{0x3000, 0x00},
	{0x3002, 0x00},{0x3004, 0xff},{0x3006, 0xff},
	{0x300e, 0x58},{0x302e, 0x00},{0x4300, 0x30},
	{0x501f, 0x00},{0x4713, 0x02}, {0x4407, 0x04},
	{0x440e, 0x00},{0x460b, 0x35},{0x460c, 0x22},
	{0x4837, 0x16},{0x4827, 0x16},{0x3824, 0x04},
	{0x5000, 0xa7},{0x5001, 0x83},{0x5180, 0xff},
	{0x5181, 0xf2},{0x5182, 0x00},{0x5183, 0x14},
	{0x5184, 0x25},{0x5185, 0x24},{0x5186, 0x09},
	{0x5187, 0x09},{0x5188, 0x09},{0x5189, 0x75},
	{0x518a, 0x54},{0x518b, 0xe0},{0x518c, 0xb2},
	{0x518d, 0x42},{0x518e, 0x3d},{0x518f, 0x56},
	{0x5190, 0x46},{0x5191, 0xf8},{0x5192, 0x04},
	{0x5193, 0x70},{0x5194, 0xf0},{0x5195, 0xf0},
	{0x5196, 0x03},{0x5197, 0x01},{0x5198, 0x04},
	{0x5199, 0x12},{0x519a, 0x04},{0x519b, 0x00},
	{0x519c, 0x06},{0x519d, 0x82},{0x519e, 0x38},
	{0x5381, 0x1e},{0x5382, 0x5b},{0x5383, 0x08},
	{0x5384, 0x0a},{0x5385, 0x7e},{0x5386, 0x88},
	{0x5387, 0x7c},{0x5388, 0x6c},{0x5389, 0x10},
	{0x538a, 0x01},{0x538b, 0x98},{0x5300, 0x08},
	{0x5301, 0x30},{0x5302, 0x10},{0x5303, 0x00},
	{0x5304, 0x08},{0x5305, 0x30},{0x5306, 0x08},
	{0x5307, 0x16},{0x5309, 0x08},{0x530a, 0x30},
	{0x530b, 0x04},{0x530c, 0x06},{0x5480, 0x01},
	{0x5481, 0x08},{0x5482, 0x14},{0x5483, 0x28},
	{0x5484, 0x51},{0x5485, 0x65},{0x5486, 0x71},
	{0x5487, 0x7d},{0x5488, 0x87},{0x5489, 0x91},
	{0x548a, 0x9a},{0x548b, 0xaa},{0x548c, 0xb8},
	{0x548d, 0xcd},{0x548e, 0xdd},{0x548f, 0xea},
	{0x5490, 0x1d},{0x5580, 0x02},{0x5583, 0x40},
	{0x5584, 0x10},{0x5589, 0x10},{0x558a, 0x00},
	{0x558b, 0xf8},{0x5800, 0x23},{0x5801, 0x14},
	{0x5802, 0x0f},{0x5803, 0x0f},{0x5804, 0x12},
	{0x5805, 0x26},{0x5806, 0x0c},{0x5807, 0x08},
	{0x5808, 0x05},{0x5809, 0x05},{0x580a, 0x08},
	{0x580b, 0x0d},{0x580c, 0x08},{0x580d, 0x03},
	{0x580e, 0x00},{0x580f, 0x00},{0x5810, 0x03},
	{0x5811, 0x09},{0x5812, 0x07},{0x5813, 0x03},
	{0x5814, 0x00},{0x5815, 0x01},{0x5816, 0x03},
	{0x5817, 0x08},{0x5818, 0x0d},{0x5819, 0x08},
	{0x581a, 0x05},{0x581b, 0x06},{0x581c, 0x08},
	{0x581d, 0x0e},{0x581e, 0x29},{0x581f, 0x17},
	{0x5820, 0x11},{0x5821, 0x11},{0x5822, 0x15},
	{0x5823, 0x28},{0x5824, 0x46},{0x5825, 0x26},
	{0x5826, 0x08},{0x5827, 0x26},{0x5828, 0x64},
	{0x5829, 0x26},{0x582a, 0x24},{0x582b, 0x22},
	{0x582c, 0x24},{0x582d, 0x24},{0x582e, 0x06},
	{0x582f, 0x22},{0x5830, 0x40},{0x5831, 0x42},
	{0x5832, 0x24},{0x5833, 0x26},{0x5834, 0x24},
	{0x5835, 0x22},{0x5836, 0x22},{0x5837, 0x26},
	{0x5838, 0x44},{0x5839, 0x24},{0x583a, 0x26},
	{0x583b, 0x28},{0x583c, 0x42},{0x583d, 0xce},
	{0x5025, 0x00},{0x3a0f, 0x30},{0x3a10, 0x28},
	{0x3a1b, 0x30},{0x3a1e, 0x26},{0x3a11, 0x60},
	{0x3a1f, 0x14},{0x3008, 0x02},{0x3035, 0x21},
	{0x4602, 0x05},{0x4603, 0x00},{0x4604, 0x04},
	{0x4605, 0x38},
};






/* 720P SETTINGS*/
//Jpeg 5MP
static struct OV5640_REGSETT  Jpeg_ov5640_setting_15fps_720_1280_720[]={
{ 0x3103, 0x11},{ 0x3008, 0x82},{ 0x3008, 0x42 },
{ 0x3103, 0x03},{ 0x3017, 0xff},{ 0x3018, 0xff},
{ 0x3034, 0x1a},{ 0x3035, 0x11},{ 0x3036, 0x69},
{ 0x3037, 0x14},{ 0x3108, 0x01},{ 0x3630, 0x36},
{ 0x3631, 0x0e},{ 0x3632, 0xe2},{ 0x3633, 0x12},
{ 0x3621, 0xe0},{ 0x3704, 0xa0},{ 0x3703, 0x5a},
{ 0x3715, 0x78},{ 0x3717, 0x01},{ 0x370b, 0x60},
{ 0x3705, 0x1a},{ 0x3905, 0x02},{ 0x3906, 0x10},
{ 0x3901, 0x0a},{ 0x3731, 0x12},{ 0x3600, 0x08},
{ 0x3601, 0x33},{ 0x302d, 0x60},{ 0x3620, 0x52},
{ 0x371b, 0x20},{ 0x471c, 0x50},{ 0x3a13, 0x43},
{ 0x3a18, 0x00},{ 0x3a19, 0xf8},{ 0x3635, 0x13},
{ 0x3636, 0x03},{ 0x3634, 0x40},{ 0x3622, 0x01},
{ 0x3c01, 0x34},{ 0x3c04, 0x28},{ 0x3c05, 0x98},
{ 0x3c06, 0x00},{ 0x3c07, 0x07},{ 0x3c08, 0x00},
{ 0x3c09, 0x1c},{ 0x3c0a, 0x9c},{ 0x3c0b, 0x40},
{ 0x3820, 0x41},{ 0x3821, 0x27},{ 0x3814, 0x31},
{ 0x3815, 0x31},{ 0x3800, 0x00},{ 0x3801, 0x00},
{ 0x3802, 0x00},{ 0x3803, 0xfa},{ 0x3804, 0x0a},
{ 0x3805, 0x3f},{ 0x3806, 0x06},{ 0x3807, 0xa9},
{ 0x3808, 0x05},{ 0x3809, 0x00},{ 0x380a, 0x02},
{ 0x380b, 0xd0},{ 0x380c, 0x07},{ 0x380d, 0x64},
{ 0x380e, 0x02},{ 0x380f, 0xe4},{ 0x3810, 0x00},
{ 0x3811, 0x10},{ 0x3812, 0x00},{ 0x3813, 0x04},
{ 0x3618, 0x00},{ 0x3612, 0x29},{ 0x3708, 0x62},
{ 0x3709, 0x52},{ 0x370c, 0x03},{ 0x3a02, 0x02},
{ 0x3a03, 0xe4},{ 0x3a08, 0x01},{ 0x3a09, 0xbc},
{ 0x3a0a, 0x01},{ 0x3a0b, 0x72},{ 0x3a0e, 0x01},
{ 0x3a0d, 0x02},{ 0x3a14, 0x02},{ 0x3a15, 0xe4},
{ 0x4001, 0x02},{ 0x4004, 0x02},{ 0x3000, 0x00},
{ 0x3002, 0x00},{ 0x3004, 0xff},{ 0x3006, 0xff},
{ 0x300e, 0x58},{ 0x302e, 0x00},{ 0x4300, 0x30},
{ 0x501f, 0x00},{ 0x4713, 0x02},
#if 0
{ 0x4400, 0x81}, { 0x4402, 0x10}, { 0x4408, 0x00}, //OVIYA
#endif
{ 0x4407, 0x04},{ 0x440e, 0x00},{ 0x460b, 0x35},
{ 0x460c, 0x22},{ 0x4827, 0x16},{ 0x3824, 0x04},
{ 0x5000, 0xa7},{ 0x5001, 0x83},{ 0x5180, 0xff},
{ 0x5181, 0xf2},{ 0x5182, 0x00},{ 0x5183, 0x14},
{ 0x5184, 0x25},{ 0x5185, 0x24},{ 0x5186, 0x09},
{ 0x5187, 0x09},{ 0x5188, 0x09},{ 0x5189, 0x75},
{ 0x518a, 0x54},{ 0x518b, 0xe0},{ 0x518c, 0xb2},
{ 0x518d, 0x42},{ 0x518e, 0x3d},{ 0x518f, 0x56},
{ 0x5190, 0x46},{ 0x5191, 0xf8},{ 0x5192, 0x04},
{ 0x5193, 0x70},{ 0x5194, 0xf0},{ 0x5195, 0xf0},
{ 0x5196, 0x03},{ 0x5197, 0x01},{ 0x5198, 0x04},
{ 0x5199, 0x12},{ 0x519a, 0x04},{ 0x519b, 0x00},
{ 0x519c, 0x06},{ 0x519d, 0x82},{ 0x519e, 0x38},
{ 0x5381, 0x1e},{ 0x5380, 0x02},{ 0x5382, 0x5b},
{ 0x5383, 0x08},{ 0x5384, 0x0a},{ 0x5385, 0x7e},
{ 0x5386, 0x88},{ 0x5387, 0x7c},{ 0x5388, 0x6c},
{ 0x5389, 0x10},{ 0x538a, 0x01},{ 0x538b, 0x98},
{ 0x5300, 0x08},{ 0x5301, 0x30},{ 0x5302, 0x10},
{ 0x5303, 0x00},{ 0x5304, 0x08},{ 0x5305, 0x30},
{ 0x5306, 0x08},{ 0x5307, 0x16},{ 0x5309, 0x08},
{ 0x530a, 0x30},{ 0x530b, 0x04},{ 0x530c, 0x06},
{ 0x5480, 0x01},{ 0x5481, 0x08},{ 0x5482, 0x14},
{ 0x5483, 0x28},{ 0x5484, 0x51},{ 0x5485, 0x65},
{ 0x5486, 0x71},{ 0x5487, 0x7d},{ 0x5488, 0x87},
{ 0x5489, 0x91},{ 0x548a, 0x9a},{ 0x548b, 0xaa},
{ 0x548c, 0xb8},{ 0x548d, 0xcd},{ 0x548e, 0xdd},
{ 0x548f, 0xea},{ 0x5490, 0x1d},{ 0x5580, 0x02},
{ 0x5583, 0x40},{ 0x5584, 0x10},{ 0x5589, 0x10},
{ 0x558a, 0x00},{ 0x558b, 0xf8},{ 0x5800, 0x23},
{ 0x5801, 0x14},{ 0x5802, 0x0f},{ 0x5803, 0x0f},
{ 0x5804, 0x12},{ 0x5805, 0x26},{ 0x5806, 0x0c},
{ 0x5807, 0x08},{ 0x5808, 0x05},{ 0x5809, 0x05},
{ 0x580a, 0x08},{ 0x580b, 0x0d},{ 0x580c, 0x08},
{ 0x580d, 0x03},{ 0x580e, 0x00},{ 0x580f, 0x00},
{ 0x5810, 0x03},{ 0x5811, 0x09},{ 0x5812, 0x07},
{ 0x5813, 0x03},{ 0x5814, 0x00},{ 0x5815, 0x01},
{ 0x5816, 0x03},{ 0x5817, 0x08},{ 0x5818, 0x0d},
{ 0x5819, 0x08},{ 0x581a, 0x05},{ 0x581b, 0x06},
{ 0x581c, 0x08},{ 0x581d, 0x0e},{ 0x581e, 0x29},
{ 0x581f, 0x17},{ 0x5820, 0x11},{ 0x5821, 0x11},
{ 0x5822, 0x15},{ 0x5823, 0x28},{ 0x5824, 0x46},
{ 0x5825, 0x26},{ 0x5826, 0x08},{ 0x5827, 0x26},
{ 0x5828, 0x64},{ 0x5829, 0x26},{ 0x582a, 0x24},
{ 0x582b, 0x22},{ 0x582c, 0x24},{ 0x582d, 0x24},
{ 0x582e, 0x06},{ 0x582f, 0x22},{ 0x5830, 0x40},
{ 0x5831, 0x42},{ 0x5832, 0x24},{ 0x5833, 0x26},
{ 0x5834, 0x24},{ 0x5835, 0x22},{ 0x5836, 0x22},
{ 0x5837, 0x26},{ 0x5838, 0x44},{ 0x5839, 0x24},
{ 0x583a, 0x26},{ 0x583b, 0x28},{ 0x583c, 0x42},
{ 0x583d, 0xce} ,{ 0x5025, 0x00},{ 0x3a0f, 0x30},
{ 0x3a10, 0x28},{ 0x3a1b, 0x30},{ 0x3a1e, 0x26},
{ 0x3a11, 0x60},{ 0x3a1f, 0x14},{ 0x3008, 0x02},
{ 0x3035, 0x21},{ 0x4602, 0x05},{ 0x4603, 0x00},
{ 0x4604, 0x04},{ 0x4605, 0x38},     

};



/* 1080P SETTINGS*/
static struct OV5640_REGSETT  Jpeg_ov5640_setting_30fps_1920_1080[]={
{ 0x3103, 0x11},{ 0x3008, 0x82},{ 0x3008, 0x42},
{ 0x3103, 0x03},{ 0x3017, 0xff},{ 0x3018, 0xff},
{ 0x3034, 0x1a},{ 0x3035, 0x11},{ 0x3036, 0x69},
{ 0x3037, 0x13 },{ 0x3108, 0x01},{ 0x3630, 0x36},
{ 0x3631, 0x0e},{ 0x3632, 0xe2},{ 0x3633, 0x12},
{ 0x3621, 0xe0},{ 0x3704, 0xa0},{ 0x3703, 0x5a},
{ 0x3715, 0x78},{ 0x3717, 0x01},{ 0x370b, 0x60},
{ 0x3705, 0x1a},{ 0x3905, 0x02},{ 0x3906, 0x10},
{ 0x3901, 0x0a},{ 0x3731, 0x12},{ 0x3600, 0x08},
{ 0x3601, 0x33},{ 0x302d, 0x60},{ 0x3620, 0x52},
{ 0x371b, 0x20},{ 0x471c, 0x50},{ 0x3a13, 0x43},
{ 0x3a18, 0x00},{ 0x3a19, 0xf8},{ 0x3635, 0x13},
{ 0x3636, 0x03},{ 0x3634, 0x40},{ 0x3622, 0x01},
{ 0x3c01, 0x34},{ 0x3c04, 0x28},{ 0x3c05, 0x98},
{ 0x3c06, 0x00},{ 0x3c07, 0x07},{ 0x3c08, 0x00},
{ 0x3c09, 0x1c},{ 0x3c0a, 0x9c},{ 0x3c0b, 0x40},
{ 0x3820, 0x41},{ 0x3821, 0x26},{ 0x3814, 0x11},
{ 0x3815, 0x11},{ 0x3800, 0x01},{ 0x3801, 0x50},
{ 0x3802, 0x01},{ 0x3803, 0xb2},{ 0x3804, 0x08},
{ 0x3805, 0xef},{ 0x3806, 0x05},{ 0x3807, 0xf2},
{ 0x3808, 0x07},{ 0x3809, 0x80},{ 0x380a, 0x04},
{ 0x380b, 0x38},{ 0x380c, 0x09},{ 0x380d, 0xc4},
{ 0x380e, 0x04},{ 0x380f, 0x60},{ 0x3810, 0x00},
{ 0x3811, 0x10},{ 0x3812, 0x00},{ 0x3813, 0x04},
{ 0x3618, 0x04},{ 0x3612, 0x2b},{ 0x3708, 0x62},
{ 0x3709, 0x12},{ 0x370c, 0x00},{ 0x3a02, 0x04},
{ 0x3a03, 0x60},{ 0x3a08, 0x01},{ 0x3a09, 0x50},
{ 0x3a0a, 0x01},{ 0x3a0b, 0x18},{ 0x3a0e, 0x03},
{ 0x3a0d, 0x04},{ 0x3a14, 0x04},{ 0x3a15, 0x60},
{ 0x4001, 0x02},{ 0x4004, 0x06},{ 0x3000, 0x00},
{ 0x3002, 0x00},{ 0x3004, 0xff},{ 0x3006, 0xff},
{ 0x300e, 0x58},{ 0x302e, 0x00},{ 0x4300, 0x30},
{ 0x501f, 0x00},{ 0x4713, 0x02},{ 0x4407, 0x04},
{ 0x440e, 0x00},{ 0x460b, 0x35},{ 0x460c, 0x22},
{ 0x4827, 0x16},{ 0x4827, 0x16},{ 0x3824, 0x04},
{ 0x5000, 0xa7},{ 0x5001, 0x83},{ 0x5180, 0xff},
{ 0x5181, 0xf2},{ 0x5182, 0x00},{ 0x5183, 0x14},
{ 0x5184, 0x25},{ 0x5185, 0x24},{ 0x5186, 0x09},
{ 0x5187, 0x09},{ 0x5188, 0x09},{ 0x5189, 0x75},
{ 0x518a, 0x54},{ 0x518b, 0xe0},{ 0x518c, 0xb2},
{ 0x518d, 0x42},{ 0x518e, 0x3d},{ 0x518f, 0x56},
{ 0x5190, 0x46},{ 0x5191, 0xf8},{ 0x5192, 0x04},
{ 0x5193, 0x70},{ 0x5194, 0xf0},{ 0x5195, 0xf0},
{ 0x5196, 0x03},{ 0x5197, 0x01},{ 0x5198, 0x04},
{ 0x5199, 0x12},{ 0x519a, 0x04},{ 0x519b, 0x00},
{ 0x519c, 0x06},{ 0x519d, 0x82},{ 0x519e, 0x38},
{ 0x5381, 0x1e},{ 0x5380, 0x02},{ 0x5382, 0x5b},
{ 0x5383, 0x08},{ 0x5384, 0x0a},{ 0x5385, 0x7e},
{ 0x5386, 0x88},{ 0x5387, 0x7c},{ 0x5388, 0x6c},
{ 0x5389, 0x10},{ 0x538a, 0x01},{ 0x538b, 0x98},
{ 0x5300, 0x08},{ 0x5301, 0x30},{ 0x5302, 0x10},
{ 0x5303, 0x00},{ 0x5304, 0x08},{ 0x5305, 0x30},
{ 0x5306, 0x08},{ 0x5307, 0x16},{ 0x5309, 0x08},
{ 0x530a, 0x30},{ 0x530b, 0x04},{ 0x530c, 0x06},
{ 0x5480, 0x01},{ 0x5481, 0x08},{ 0x5482, 0x14},
{ 0x5483, 0x28},{ 0x5484, 0x51},{ 0x5485, 0x65},
{ 0x5486, 0x71},{ 0x5487, 0x7d},{ 0x5488, 0x87},
{ 0x5489, 0x91},{ 0x548a, 0x9a},{ 0x548b, 0xaa},
{ 0x548c, 0xb8},{ 0x548d, 0xcd},{ 0x548e, 0xdd},
{ 0x548f, 0xea},{ 0x5490, 0x1d},{ 0x5580, 0x02},
{ 0x5583, 0x40},{ 0x5584, 0x10},{ 0x5589, 0x10},
{ 0x558a, 0x00},{ 0x558b, 0xf8},{ 0x5800, 0x23},
{ 0x5801, 0x14},{ 0x5802, 0x0f},{ 0x5803, 0x0f},
{ 0x5804, 0x12},{ 0x5805, 0x26},{ 0x5806, 0x0c},
{ 0x5807, 0x08},{ 0x5808, 0x05},{ 0x5809, 0x05},
{ 0x580a, 0x08},{ 0x580b, 0x0d},{ 0x580c, 0x08},
{ 0x580d, 0x03},{ 0x580e, 0x00},{ 0x580f, 0x00},
{ 0x5810, 0x03},{ 0x5811, 0x09},{ 0x5812, 0x07},
{ 0x5813, 0x03},{ 0x5814, 0x00},{ 0x5815, 0x01},
{ 0x5816, 0x03},{ 0x5817, 0x08},{ 0x5818, 0x0d},
{ 0x5819, 0x08},{ 0x581a, 0x05},{ 0x581b, 0x06},
{ 0x581c, 0x08},{ 0x581d, 0x0e},{ 0x581e, 0x29},
{ 0x581f, 0x17},{ 0x5820, 0x11},{ 0x5821, 0x11},
{ 0x5822, 0x15},{ 0x5823, 0x28},{ 0x5824, 0x46},
{ 0x5825, 0x26},{ 0x5826, 0x08},{ 0x5827, 0x26},
{ 0x5828, 0x64},{ 0x5829, 0x26},{ 0x582a, 0x24},
{ 0x582b, 0x22},{ 0x582c, 0x24},{ 0x582d, 0x24},
{ 0x582e, 0x06},{ 0x582f, 0x22},{ 0x5830, 0x40},
{ 0x5831, 0x42},{ 0x5832, 0x24},{ 0x5833, 0x26},
{ 0x5834, 0x24},{ 0x5835, 0x22},{ 0x5836, 0x22},
{ 0x5837, 0x26},{ 0x5838, 0x44},{ 0x5839, 0x24},
{ 0x583a, 0x26},{ 0x583b, 0x28},{ 0x583c, 0x42},
{ 0x583d, 0xce},{ 0x5025, 0x00},{ 0x3a0f, 0x30},
{ 0x3a10, 0x28},{ 0x3a1b, 0x30},{ 0x3a1e, 0x26},
{ 0x3a11, 0x60},{ 0x3a1f, 0x14},{ 0x3008, 0x02},
{ 0x3035, 0x21},{ 0x4602, 0x05},{ 0x4603, 0x00},
{ 0x4604, 0x04},{ 0x4605, 0x38}, 
};



//Jpeg 5MP
static struct OV5640_REGSETT  Jpeg_ov5640_setting_15fps_QSXGA_2592_1944[]={
/* 5MP SETTINGS */
{0x3103, 0x11},{0x3008, 0x82},{0x3008, 0x42},
{0x3103, 0x03},{0x3017, 0xff},{0x3018, 0xff},
{0x3034, 0x1a},{0x3035, 0x11},{0x3036, 0x69},
{0x3037, 0x13},{0x3108, 0x01},{0x3630, 0x36},
{0x3631, 0x0e},{0x3632, 0xe2},{0x3633, 0x12},
{0x3621, 0xe0},{0x3704, 0xa0},{0x3703, 0x5a},
{0x3715, 0x78},{0x3717, 0x01},{0x370b, 0x60},
{0x3705, 0x1a},{0x3905, 0x02},{0x3906, 0x10},
{0x3901, 0x0a},{0x3731, 0x12},{0x3600, 0x08},
{0x3601, 0x33},{0x302d, 0x60},{0x3620, 0x52},
{0x371b, 0x20},{0x471c, 0x50},{0x3a13, 0x43},
{0x3a18, 0x00},{0x3a19, 0xf8},{0x3635, 0x13},
{0x3636, 0x03},{0x3634, 0x40},{0x3622, 0x01},
{0x3c01, 0x34},{0x3c04, 0x28},{0x3c05, 0x98},
{0x3c06, 0x00},{0x3c07, 0x07},{0x3c08, 0x00},
{0x3c09, 0x1c},{0x3c0a, 0x9c},{0x3c0b, 0x40},
{0x3820, 0x41},{0x3821, 0x26},{0x3814, 0x11},
{0x3815, 0x11},{0x3800, 0x00},{0x3801, 0x00},
{0x3802, 0x00},{0x3803, 0x00},{0x3804, 0x0a},
{0x3805, 0x3f},{0x3806, 0x07},{0x3807, 0x9f},
{0x3808, 0x0a},{0x3809, 0x20},{0x380a, 0x07},
{0x380b, 0x98},{0x380c, 0x0b},{0x380d, 0x1c},
{0x380e, 0x07},{0x380f, 0xb0},{0x3810, 0x00},
{0x3811, 0x10},{0x3812, 0x00},{0x3813, 0x04},
{0x3618, 0x04},{0x3612, 0x2b},{0x3708, 0x64},
{0x3709, 0x12},{0x370c, 0x00},{0x3a02, 0x07},
{0x3a03, 0xb0},{0x3a08, 0x01},{0x3a09, 0x27},
{0x3a0a, 0x00},{0x3a0b, 0xf6},{0x3a0e, 0x06},
{0x3a0d, 0x08},{0x3a14, 0x07},{0x3a15, 0xb0},
{0x4001, 0x02},{0x4004, 0x06},{0x3000, 0x00},
{0x3002, 0x00},{0x3004, 0xff},{0x3006, 0xff},
{0x300e, 0x58},{0x302e, 0x00},{0x4300, 0x30},
{0x501f, 0x00},{0x4713, 0x02}, {0x4407, 0x04},
{0x440e, 0x00},{0x460b, 0x35},{0x460c, 0x22},
{0x4837, 0x16},{0x4827, 0x16},{0x3824, 0x04},
{0x5000, 0xa7},{0x5001, 0x83},{0x5180, 0xff},
{0x5181, 0xf2},{0x5182, 0x00},{0x5183, 0x14},
{0x5184, 0x25},{0x5185, 0x24},{0x5186, 0x09},
{0x5187, 0x09},{0x5188, 0x09},{0x5189, 0x75},
{0x518a, 0x54},{0x518b, 0xe0},{0x518c, 0xb2},
{0x518d, 0x42},{0x518e, 0x3d},{0x518f, 0x56},
{0x5190, 0x46},{0x5191, 0xf8},{0x5192, 0x04},
{0x5193, 0x70},{0x5194, 0xf0},{0x5195, 0xf0},
{0x5196, 0x03},{0x5197, 0x01},{0x5198, 0x04},
{0x5199, 0x12},{0x519a, 0x04},{0x519b, 0x00},
{0x519c, 0x06},{0x519d, 0x82},{0x519e, 0x38},
{0x5381, 0x1e},{0x5382, 0x5b},{0x5383, 0x08},
{0x5384, 0x0a},{0x5385, 0x7e},{0x5386, 0x88},
{0x5387, 0x7c},{0x5388, 0x6c},{0x5389, 0x10},
{0x538a, 0x01},{0x538b, 0x98},{0x5300, 0x08},
{0x5301, 0x30},{0x5302, 0x10},{0x5303, 0x00},
{0x5304, 0x08},{0x5305, 0x30},{0x5306, 0x08},
{0x5307, 0x16},{0x5309, 0x08},{0x530a, 0x30},
{0x530b, 0x04},{0x530c, 0x06},{0x5480, 0x01},
{0x5481, 0x08},{0x5482, 0x14},{0x5483, 0x28},
{0x5484, 0x51},{0x5485, 0x65},{0x5486, 0x71},
{0x5487, 0x7d},{0x5488, 0x87},{0x5489, 0x91},
{0x548a, 0x9a},{0x548b, 0xaa},{0x548c, 0xb8},
{0x548d, 0xcd},{0x548e, 0xdd},{0x548f, 0xea},
{0x5490, 0x1d},{0x5580, 0x02},{0x5583, 0x40},
{0x5584, 0x10},{0x5589, 0x10},{0x558a, 0x00},
{0x558b, 0xf8},{0x5800, 0x23},{0x5801, 0x14},
{0x5802, 0x0f},{0x5803, 0x0f},{0x5804, 0x12},
{0x5805, 0x26},{0x5806, 0x0c},{0x5807, 0x08},
{0x5808, 0x05},{0x5809, 0x05},{0x580a, 0x08},
{0x580b, 0x0d},{0x580c, 0x08},{0x580d, 0x03},
{0x580e, 0x00},{0x580f, 0x00},{0x5810, 0x03},
{0x5811, 0x09},{0x5812, 0x07},{0x5813, 0x03},
{0x5814, 0x00},{0x5815, 0x01},{0x5816, 0x03},
{0x5817, 0x08},{0x5818, 0x0d},{0x5819, 0x08},
{0x581a, 0x05},{0x581b, 0x06},{0x581c, 0x08},
{0x581d, 0x0e},{0x581e, 0x29},{0x581f, 0x17},
{0x5820, 0x11},{0x5821, 0x11},{0x5822, 0x15},
{0x5823, 0x28},{0x5824, 0x46},{0x5825, 0x26},
{0x5826, 0x08},{0x5827, 0x26},{0x5828, 0x64},
{0x5829, 0x26},{0x582a, 0x24},{0x582b, 0x22},
{0x582c, 0x24},{0x582d, 0x24},{0x582e, 0x06},
{0x582f, 0x22},{0x5830, 0x40},{0x5831, 0x42},
{0x5832, 0x24},{0x5833, 0x26},{0x5834, 0x24},
{0x5835, 0x22},{0x5836, 0x22},{0x5837, 0x26},
{0x5838, 0x44},{0x5839, 0x24},{0x583a, 0x26},
{0x583b, 0x28},{0x583c, 0x42},{0x583d, 0xce},
{0x5025, 0x00},{0x3a0f, 0x30},{0x3a10, 0x28},
{0x3a1b, 0x30},{0x3a1e, 0x26},{0x3a11, 0x60},
{0x3a1f, 0x14},{0x3008, 0x02},{0x3035, 0x21},
{0x4602, 0x05},{0x4603, 0x00},{0x4604, 0x04},
{0x4605, 0x38},

};




#endif



/* Private function prototypes -----------------------------------------------*/
/* Private functions ---------------------------------------------------------*/

/**
  * @brief  Initializes the hardware resources (I2C and GPIO) used to configure 
  *         the OV2640 camera.
  * @param  None
  * @retval None
  */
//void OV2640_HW_Init(void)
	
void OV5640_HW_Init (void)
{
  GPIO_InitTypeDef GPIO_InitStructure;
  I2C_InitTypeDef  I2C_InitStruct;

  /*** Configures the DCMI GPIOs to interface with the OV2640 camera module ***/
  /* Enable DCMI GPIOs clocks */
//vv  RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOA | RCC_AHB1Periph_GPIOH | 
//vv                         RCC_AHB1Periph_GPIOI, ENABLE);

	RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOA | RCC_AHB1Periph_GPIOB | 
                         RCC_AHB1Periph_GPIOC |RCC_AHB1Periph_GPIOG, ENABLE);
	
#if 0	
  /* Connect DCMI pins to AF13 */
  GPIO_PinAFConfig(GPIOA, GPIO_PinSource6, GPIO_AF_DCMI);

  GPIO_PinAFConfig(GPIOH, GPIO_PinSource8, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOH, GPIO_PinSource9, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOH, GPIO_PinSource10, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOH, GPIO_PinSource11, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOH, GPIO_PinSource12, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOH, GPIO_PinSource14, GPIO_AF_DCMI);

  GPIO_PinAFConfig(GPIOI, GPIO_PinSource5, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOI, GPIO_PinSource6, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOI, GPIO_PinSource7, GPIO_AF_DCMI);
  GPIO_PinAFConfig(GPIOI, GPIO_PinSource4, GPIO_AF_DCMI);
	
	  /* DCMI GPIO configuration */
  /* D0..D4(PH9/10/11/12/14), HSYNC(PH8) */
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_11 | 
                                GPIO_Pin_12 | GPIO_Pin_14| GPIO_Pin_8;
  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
  GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP ;
  GPIO_Init(GPIOH, &GPIO_InitStructure);

  /* D5..D7(PI4/6/7), VSYNC(PI5) */
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4 | GPIO_Pin_6 | GPIO_Pin_7 | GPIO_Pin_5;
  GPIO_Init(GPIOI, &GPIO_InitStructure);

  /* PCLK(PA6) */
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6;
  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
  GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
  GPIO_Init(GPIOA, &GPIO_InitStructure);
	#endif

//OV5640//
/* Connect DCMI pins to AF13 */
  GPIO_PinAFConfig(GPIOA, GPIO_PinSource4, GPIO_AF_DCMI);     //PA4   HSYNC
  GPIO_PinAFConfig(GPIOA, GPIO_PinSource6, GPIO_AF_DCMI);     //PA6   PIXCLK
  GPIO_PinAFConfig(GPIOA, GPIO_PinSource9, GPIO_AF_DCMI);     //PA9   S_CSIO_DAT12
	GPIO_PinAFConfig(GPIOA, GPIO_PinSource10, GPIO_AF_DCMI);    //PA10  S_CSIO_DAT13
	
  GPIO_PinAFConfig(GPIOC, GPIO_PinSource8, GPIO_AF_DCMI);     //PC8   S_CSIO_DAT14
	GPIO_PinAFConfig(GPIOC, GPIO_PinSource9, GPIO_AF_DCMI);     //PC9   S_CSIO_DAT15
	GPIO_PinAFConfig(GPIOC, GPIO_PinSource11, GPIO_AF_DCMI);    //PC11  S_CSIO_DAT16

  GPIO_PinAFConfig(GPIOB, GPIO_PinSource6, GPIO_AF_DCMI);     //PB6    S_CSIO_DAT17
  GPIO_PinAFConfig(GPIOB, GPIO_PinSource7, GPIO_AF_DCMI);     //PB7    VSYNC
	GPIO_PinAFConfig(GPIOB, GPIO_PinSource8, GPIO_AF_DCMI);     //PB8    S_CSIO_DAT18
	GPIO_PinAFConfig(GPIOB, GPIO_PinSource9, GPIO_AF_DCMI);     //PB9    S_CSIO_DAT19
	
	/*
	CSI0_RSTB-PG6
	CSI0_PWDN-PG7
	I2C_SCK/S_KEY_COL3-PB10
	I2C_SDA/S_KEY_ROW3-PB11
	*/
  
//OV5640//
 
  /* DCMI GPIO configuration */
  /* (DAT12,13, D0..D4(PA4/9/10) PA4   HSYNC ) */
	
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9 | GPIO_Pin_10 | GPIO_Pin_4 ;
                                
  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
  GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP ;
  GPIO_Init(GPIOA, &GPIO_InitStructure);

  /* D5..D7(PI4/6/7), VSYNC(PI5) */
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4 | GPIO_Pin_6 | GPIO_Pin_7 | GPIO_Pin_5;
  GPIO_Init(GPIOI, &GPIO_InitStructure);

  /* PCLK(PA6)   -PIXCLK*/
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6;
  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
  GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
  GPIO_Init(GPIOA, &GPIO_InitStructure);

  /****** Configures the I2C1 used for OV5640 camera module configuration *****/
 /* I2C2 clock enable */
  RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C2, ENABLE);

  /* GPIOB clock enable */
  RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOB, ENABLE);

  /* Connect I2C2 pins to AF4 */
  GPIO_PinAFConfig(GPIOB, GPIO_PinSource10, GPIO_AF_I2C2);
  GPIO_PinAFConfig(GPIOB, GPIO_PinSource11, GPIO_AF_I2C2);
  
  /* Configure I2C2 GPIOs */  
  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10 | GPIO_Pin_11;
  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_2MHz;
  GPIO_InitStructure.GPIO_OType = GPIO_OType_OD;
  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;
  GPIO_Init(GPIOB, &GPIO_InitStructure);

  /* Configure I2C2 -PB10 and PB11 */
  /* I2C DeInit */ 
  I2C_DeInit(I2C2);
    
  /* Enable the I2C peripheral */
  I2C_Cmd(I2C2, ENABLE);
 
  /* Set the I2C structure parameters */
  I2C_InitStruct.I2C_Mode = I2C_Mode_I2C;
  I2C_InitStruct.I2C_DutyCycle = I2C_DutyCycle_2;
  I2C_InitStruct.I2C_OwnAddress1 = 0x3c; //0xFE;
  I2C_InitStruct.I2C_Ack = I2C_Ack_Enable;
  I2C_InitStruct.I2C_AcknowledgedAddress = I2C_AcknowledgedAddress_7bit;
 // I2C_InitStruct.I2C_ClockSpeed = 30000;
  I2C_InitStruct.I2C_ClockSpeed = I2C_SPEED;  //100KHZ
  /* Initialize the I2C peripheral w/ selected parameters */
  I2C_Init(I2C2, &I2C_InitStruct);
	
}

/**
  * @brief  Resets the OV5640 camera.
  * @param  None
  * @retval None
  */
void OV5640_Reset(void)
{
  OV5640_WriteReg(0x3103, 0x11);
  OV5640_WriteReg(0x3008, 0x82);
//	msleep(10);
	Delay(10);
}

/**
  * @brief  Reads the OV2640 Manufacturer identifier.
  * @param  OV2640ID: Pointer to the OV2640 Manufacturer identifier
  * @retval None
  */

#if 0
void OV2640_ReadID(OV2640_IDTypeDef *OV2640ID)
{
  OV2640_WriteReg(OV2640_DSP_RA_DLMT, 0x01);
  OV2640ID->Manufacturer_ID1 = OV2640_ReadReg(OV2640_SENSOR_MIDH);
  OV2640ID->Manufacturer_ID2 = OV2640_ReadReg(OV2640_SENSOR_MIDL);
  OV2640ID->PIDH = OV2640_ReadReg(OV2640_SENSOR_PIDH);
  OV2640ID->PIDL = OV2640_ReadReg(OV2640_SENSOR_PIDL);
}

#endif

void OV5640_ReadID(OV5640_IDTypeDef *OV5640ID)
{
	
  OV5640ID->Manufacturer_IDH = OV5640_ReadReg(OV5640_CHIP_ID_HIGH_BYTE);
  OV5640ID->Manufacturer_IDL = OV5640_ReadReg(OV5640_CHIP_ID_LOW_BYTE);
 
}


/**
  * @brief  Configures DCMI/DMA to capture image from the OV2640 camera.
  * @param  ImageFormat: Image format BMP or JPEG 
  * @param  BMPImageSize: BMP Image size
  * @retval None
  */
//void OV2640_Init(ImageFormat_TypeDef ImageFormat)

//uint8_t frame_buffer[320*240*2];
uint8_t frame_buffer[640*480*2];

	void OV5640_Init(ImageFormat_TypeDef ImageFormat)
{
  DCMI_InitTypeDef DCMI_InitStructure;
  DMA_InitTypeDef  DMA_InitStructure;

  /*** Configures the DCMI to interface with the OV2640 camera module ***/
  /* Enable DCMI clock */
  RCC_AHB2PeriphClockCmd(RCC_AHB2Periph_DCMI, ENABLE);

  /* DCMI configuration */ 
  DCMI_InitStructure.DCMI_CaptureMode = DCMI_CaptureMode_Continuous; //DCMI_CaptureMode_SnapShot
  DCMI_InitStructure.DCMI_SynchroMode = DCMI_SynchroMode_Hardware;
  DCMI_InitStructure.DCMI_PCKPolarity = DCMI_PCKPolarity_Rising;
  DCMI_InitStructure.DCMI_VSPolarity = DCMI_VSPolarity_Low;
  DCMI_InitStructure.DCMI_HSPolarity = DCMI_HSPolarity_Low;
  DCMI_InitStructure.DCMI_CaptureRate = DCMI_CaptureRate_All_Frame;
  DCMI_InitStructure.DCMI_ExtendedDataMode = DCMI_ExtendedDataMode_8b;

  /* Configures the DMA2 to transfer Data from DCMI */
  /* Enable DMA2 clock */
  RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_DMA2, ENABLE);
  
  /* DMA2 Stream1 Configuration */  
  DMA_DeInit(DMA2_Stream1);

  DMA_InitStructure.DMA_Channel = DMA_Channel_1;  
 // DMA_InitStructure.DMA_PeripheralBaseAddr = DCMI_DR_ADDRESS;	//vv
//	DMA_InitStructure.DMA_PeripheralBaseAddr =  (uint32_t)(DCMI_BASE + 0x28); //vv added
  DMA_InitStructure.DMA_PeripheralBaseAddr =  (uint32_t)(DCMI_BASE); //vv added
 // DMA_InitStructure.DMA_Memory0BaseAddr = FSMC_LCD_ADDRESS;  //vv
 //DMA_InitStructure.DMA_Memory0BaseAddr =  (uint32_t)&frame_buffer[0]; //vv added
  DMA_InitStructure.DMA_Memory0BaseAddr= (uint32_t)frame_buffer; //vv added
  DMA_InitStructure.DMA_DIR = DMA_DIR_PeripheralToMemory;
 // DMA_InitStructure.DMA_BufferSize = 1;
 // DMA_InitStructure.DMA_BufferSize=frame_buffer;
  DMA_InitStructure.DMA_BufferSize = 0x25800; //(640*480*2)/4
  DMA_InitStructure.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
  DMA_InitStructure.DMA_MemoryInc = DMA_MemoryInc_Disable;
  DMA_InitStructure.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Word;
  DMA_InitStructure.DMA_MemoryDataSize = DMA_MemoryDataSize_HalfWord;
  DMA_InitStructure.DMA_Mode = DMA_Mode_Circular;   //vv check this mode DMA_Mode_Normal 0r 
  DMA_InitStructure.DMA_Priority = DMA_Priority_High;
  DMA_InitStructure.DMA_FIFOMode = DMA_FIFOMode_Enable;
  DMA_InitStructure.DMA_FIFOThreshold = DMA_FIFOThreshold_Full;
  DMA_InitStructure.DMA_MemoryBurst = DMA_MemoryBurst_Single;
  DMA_InitStructure.DMA_PeripheralBurst = DMA_PeripheralBurst_Single;

  switch(ImageFormat)
  {
#if 0
		case BMP_QQVGA:
    {
      /* DCMI configuration */ 
      DCMI_InitStructure.DCMI_VSPolarity = DCMI_VSPolarity_High;
      DCMI_Init(&DCMI_InitStructure);

      /* DMA2 IRQ channel Configuration */
      DMA_Init(DMA2_Stream1, &DMA_InitStructure);
      break;
    }
#endif
    case RAW_320x240:
    {
      /* DCMI configuration */
      DCMI_Init(&DCMI_InitStructure);

      /* DMA2 IRQ channel Configuration */
      DMA_Init(DMA2_Stream1, &DMA_InitStructure);
      break;
    }
     default:
    {
      /* DCMI configuration */ 
      DCMI_InitStructure.DCMI_VSPolarity = DCMI_VSPolarity_High;
      DCMI_Init(&DCMI_InitStructure);

      /* DMA2 IRQ channel Configuration */
      DMA_Init(DMA2_Stream1, &DMA_InitStructure);
      break;
    }
  }
	
	#if 0 //VV added
	 DMA_ITConfig(DMA2_Stream1, DMA_IT_TC | DMA_IT_TE, ENABLE);

  // DMA2 IRQ channel Configuration
  NVIC_PriorityGroupConfig(NVIC_PriorityGroup_2);
  NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
  NVIC_InitStructure.NVIC_IRQChannel = DMA2_Stream1_IRQn ;
  NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 3;
  NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
  NVIC_Init(&NVIC_InitStructure);
 // break;

  // Clears the DCMI's and DMA's pending bits
  DCMI_ClearITPendingBit(DCMI_IT_FRAME | DCMI_IT_OVF | DCMI_IT_ERR);
  DMA_ClearITPendingBit(DMA2_Stream1, DMA_IT_TCIF1 | DMA_IT_TEIF1);

  // Enable DMA2 stream 1 and DCMI interface then start new image capture
 // DMA_Cmd(DMA2_Stream1, ENABLE); 
 // DCMI_Cmd(ENABLE); 
 // DCMI_CaptureCmd(ENABLE);
	#endif //VV added
	
	
}





/****************************OVIYA Resolution***********************************************/



void OV5640_RAW_320_240(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(raw_ov5640_setting_30fps_QVGA_320_240)/sizeof(raw_ov5640_setting_30fps_QVGA_320_240[0])); i++)
  {
    OV5640_WriteReg(raw_ov5640_setting_30fps_QVGA_320_240[i].reg, raw_ov5640_setting_30fps_QVGA_320_240[i].val);
    Delay(2);
  }

};

void OV5640_RAW_640_480(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(raw_ov6540_setting_30fps_VGA_640_480)/sizeof(raw_ov6540_setting_30fps_VGA_640_480[0])); i++)
  {
    OV5640_WriteReg(raw_ov6540_setting_30fps_VGA_640_480[i].reg,raw_ov6540_setting_30fps_VGA_640_480[i].val);
    Delay(2);
  }

};


void OV5640_RAW_1280_720(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(raw_ov5640_setting_30fps_720P_1280_720)/sizeof(raw_ov5640_setting_30fps_720P_1280_720[0])); i++)
  {
    OV5640_WriteReg(raw_ov5640_setting_30fps_720P_1280_720[i].reg,raw_ov5640_setting_30fps_720P_1280_720[i].val);
    Delay(2);
  }

};


void OV5640_RAW_1920_1080(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(raw_ov5640_setting_15fps_1080P_1920_1080)/sizeof(raw_ov5640_setting_15fps_1080P_1920_1080[0])); i++)
  {
    OV5640_WriteReg(raw_ov5640_setting_15fps_1080P_1920_1080[i].reg,raw_ov5640_setting_15fps_1080P_1920_1080[i].val);
    Delay(2);
  }

};



void OV5640_RAW_5MP_QSXGA_2592_1944(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(raw_ov5640_setting_15fps_QSXGA_2592_1944)/sizeof(raw_ov5640_setting_15fps_QSXGA_2592_1944[0])); i++)
  {
    OV5640_WriteReg(raw_ov5640_setting_15fps_QSXGA_2592_1944[i].reg,raw_ov5640_setting_15fps_QSXGA_2592_1944[i].val);
    Delay(2);
  }

};


void OV5640_JPEG_1280_720(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(Jpeg_ov5640_setting_15fps_720_1280_720)/sizeof(Jpeg_ov5640_setting_15fps_720_1280_720[0])); i++)
  {
    OV5640_WriteReg(Jpeg_ov5640_setting_15fps_720_1280_720[i].reg,Jpeg_ov5640_setting_15fps_720_1280_720[i].val);
    Delay(2);
  }

};




void OV5640_JPEG_1920_1080(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(Jpeg_ov5640_setting_30fps_1920_1080)/sizeof(Jpeg_ov5640_setting_30fps_1920_1080[0])); i++)
  {
    OV5640_WriteReg(Jpeg_ov5640_setting_30fps_1920_1080[i].reg,Jpeg_ov5640_setting_30fps_1920_1080[i].val);
    Delay(2);
  }

};



void OV5640_JPEG_5MP_2592_1944(void)
{
uint32_t i;

  OV5640_Reset();
  Delay(200);
  /* Initialize OV5640 */
	for(i=0; i<(sizeof(Jpeg_ov5640_setting_15fps_QSXGA_2592_1944)/sizeof(Jpeg_ov5640_setting_15fps_QSXGA_2592_1944[0])); i++)
  {
    OV5640_WriteReg(Jpeg_ov5640_setting_15fps_QSXGA_2592_1944[i].reg,Jpeg_ov5640_setting_15fps_QSXGA_2592_1944[i].val);
    Delay(2);
  }

};



/* enable = 0 to turn off night mode
   enable = 1 to turn on night mode */
int ov5640_set_night_mode(int enable)
{
        uint8_t mode;

        mode=OV5640_ReadReg(0x3a00);

        if (enable) {
                /* night mode on */
                mode |= 0x04;
               OV5640_WriteReg(0x3a00, mode);
        } else {
                /* night mode off */
                mode &= 0xfb;
                OV5640_WriteReg(0x3a00, mode);
        }

        return 0;
}



/* enable = 0 to turn off AEC/AGC
   enable = 1 to turn on AEC/AGC */
void ov5640_turn_on_AE_AG(int enable)
{
        uint8_t ae_ag_ctrl;

        ae_ag_ctrl=OV5640_ReadReg(0x3503);
        if (enable) {
                /* turn on auto AE/AG */
                ae_ag_ctrl = ae_ag_ctrl & ~(0x03);
        } else {
                /* turn off AE/AG */
                ae_ag_ctrl = ae_ag_ctrl | 0x03;
        }
        OV5640_WriteReg(0x3503, ae_ag_ctrl);
}


int ov5640_set_VTS(int VTS)
{
        int temp;

        temp = VTS & 0xff;
        OV5640_WriteReg(0x380f, temp);

        temp = VTS>>8;
        OV5640_WriteReg(0x380e, temp);
        return 0;
}

/* read shutter, in number of line period */
int ov5640_get_shutter(void)
{
        int shutter;
        uint8_t regval;

        regval=OV5640_ReadReg(0x03500); 
        shutter= (regval & 0x0f);
	      regval=OV5640_ReadReg(0x3501);
        shutter = (shutter<<8) + regval;
	      regval=OV5640_ReadReg(0x3502);
        shutter = (shutter<<4) +(regval>>4);

        return shutter;
}



/* write shutter, in number of line period */
int ov5640_set_shutter(int shutter)
{
        int temp;

        shutter = shutter & 0xffff;
        temp = shutter & 0x0f;
        temp = temp<<4;
        OV5640_WriteReg(0x3502, temp);

        temp = shutter & 0xfff;
        temp = temp>>4;
        OV5640_WriteReg(0x3501, temp);

        temp = shutter>>12;
        OV5640_WriteReg(0x3500, temp);

        return 0;
}





/****************************OVIYA Resolution***********************************************/


/**
  * @brief  Configures the OV2640 camera in JPEG mode.
  * @param  JPEGImageSize: JPEG image size
  * @retval None
  */
void OV5640_JPEGConfig(ImageFormat_TypeDef ImageFormat)
{
  uint32_t i;

  OV5640_Reset();
  Delay(200);

#if 0 
	/* Initialize OV5640 */
  for(i=0; i<(sizeof(OV2640_JPEG_INIT)/2); i++)
  {
 //   OV5640_WriteReg(OV2640_JPEG_INIT[i][0], OV2640_JPEG_INIT[i][1]);
  }

  /* Set to output YUV422 */
  for(i=0; i<(sizeof(OV2640_YUV422)/2); i++)
  {
    OV5640_WriteReg(OV2640_YUV422[i][0], OV2640_YUV422[i][1]);
  }

  OV5640_WriteReg(0xff, 0x01);
  OV5640_WriteReg(0x15, 0x00);

  /* Set to output JPEG */
  for(i=0; i<(sizeof(OV2640_JPEG)/2); i++)
  {
    OV5640_WriteReg(OV2640_JPEG[i][0], OV2640_JPEG[i][1]);
  }
#endif
	
  Delay(100);

  switch(ImageFormat)
  {
   	case JPEG_1280_720:
      {
        /* Configure the OV2640 camera and set the QQVGA mode */
//				OV5640_HW_Init();
//				OV5640_Init(JPEG_1280_720);
        OV5640_JPEG_1280_720();
        break;
      }
			
			case JPEG_1920_1080:
      {
        /* Configure the OV2640 camera and set the QQVGA mode */
//				OV5640_HW_Init();
//				OV5640_Init(JPEG_1920_1080);
        OV5640_JPEG_1920_1080();
        break;
      }
			case JPEG_5MP_2592_1944:
      {
        /* Configure the OV2640 camera and set the QQVGA mode */
//				OV5640_HW_Init();
//				OV5640_Init(JPEG_5MP_2592_1944);
        OV5640_JPEG_5MP_2592_1944();
        break;
      }
			
    default:
    {
//		  OV5640_HW_Init();
//		  OV5640_Init(JPEG_1280_720);
      OV5640_JPEG_1280_720();
      break;
    }
  }
}

#if 0


/**
  * @brief  Configures the OV2640 camera brightness.
  * @param  Brightness: Brightness value, where Brightness can be: 
  *         0x40 for Brightness +2,
  *         0x30 for Brightness +1,
  *         0x20 for Brightness 0,
  *         0x10 for Brightness -1,
  *         0x00 for Brightness -2,
  * @retval None
  */
void OV2640_BrightnessConfig(uint8_t Brightness)
{
  OV2640_WriteReg(0xff, 0x00);
  OV2640_WriteReg(0x7c, 0x00);
  OV2640_WriteReg(0x7d, 0x04);
  OV2640_WriteReg(0x7c, 0x09);
  OV2640_WriteReg(0x7d, Brightness);
  OV2640_WriteReg(0x7d, 0x00);
}

/**
  * @brief  Configures the OV2640 camera Black and white mode.
  * @param  BlackWhite: BlackWhite value, where BlackWhite can be: 
  *         0x18 for B&W,
  *         0x40 for Negative,
  *         0x58 for B&W negative,
  *         0x00 for Normal,
  * @retval None
  */
void OV2640_BandWConfig(uint8_t BlackWhite)
{
  OV2640_WriteReg(0xff, 0x00);
  OV2640_WriteReg(0x7c, 0x00);
  OV2640_WriteReg(0x7d, BlackWhite);
  OV2640_WriteReg(0x7c, 0x05);
  OV2640_WriteReg(0x7d, 0x80);
  OV2640_WriteReg(0x7d, 0x80);
}

/**
  * @brief  Configures the OV2640 camera color effects.
  * @param  value1: Color effects value1
  * @param  value2: Color effects value2
  *         where value1 and value2 can be: 
  *         value1 = 0x40, value2 = 0xa6 for Antique,
  *         value1 = 0xa0, value2 = 0x40 for Bluish,
  *         value1 = 0x40, value2 = 0x40 for Greenish,
  *         value1 = 0x40, value2 = 0xc0 for Reddish,
  * @retval None
  */
void OV2640_ColorEffectsConfig(uint8_t value1, uint8_t value2)
{
  OV2640_WriteReg(0xff, 0x00);
  OV2640_WriteReg(0x7c, 0x00);
  OV2640_WriteReg(0x7d, 0x18);
  OV2640_WriteReg(0x7c, 0x05);
  OV2640_WriteReg(0x7d, value1);
  OV2640_WriteReg(0x7d, value2);
}

/**
  * @brief  Configures the OV2640 camera contrast.
  * @param  value1: Contrast value1
  * @param  value2: Contrast value2
  *         where value1 and value2 can be: 
  *         value1 = 0x28, value2 = 0x0c for Contrast +2,
  *         value1 = 0x24, value2 = 0x16 for Contrast +1,
  *         value1 = 0x20, value2 = 0x20 for Contrast 0,
  *         value1 = 0x1c, value2 = 0x2a for Contrast -1,
  *         value1 = 0x18, value2 = 0x34 for Contrast -2,
  * @retval None
  */
void OV2640_ContrastConfig(uint8_t value1, uint8_t value2)
{
  OV2640_WriteReg(0xff, 0x00);
  OV2640_WriteReg(0x7c, 0x00);
  OV2640_WriteReg(0x7d, 0x04);
  OV2640_WriteReg(0x7c, 0x07);
  OV2640_WriteReg(0x7d, 0x20);
  OV2640_WriteReg(0x7d, value1);
  OV2640_WriteReg(0x7d, value2);
  OV2640_WriteReg(0x7d, 0x06);
}

/**
  * @brief  Writes a byte at a specific Camera register
  * @param  Addr: OV2640 register address.
  * @param  Data: Data to be written to the specific register 
  * @retval 0x00 if write operation is OK.
  *       0xFF if timeout condition occured (device not connected or bus error).
  */


#endif
uint8_t OV5640_WriteReg(uint16_t Addr, uint8_t Data)
{
  uint32_t timeout = DCMI_TIMEOUT_MAX;
  
  /* Generate the Start Condition */
  I2C_GenerateSTART(I2C2, ENABLE);

  /* Test on I2C2 EV5 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_MODE_SELECT))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  }
   
  /* Send DCMI selcted device slave Address for write */
  I2C_Send7bitAddress(I2C2, OV5640_DEVICE_WRITE_ADDRESS, I2C_Direction_Transmitter);
 
  /* Test on I2C2 EV6 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  }
 
  /* Send I2C1 location address LSB */
  I2C_SendData(I2C2, (uint8_t)(Addr));

  /* Test on I2C2 EV8 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  }
  
  /* Send Data */
  I2C_SendData(I2C2, Data);

  /* Test on I2C2 EV8 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  }  
 
  /* Send I2C1 STOP Condition */
  I2C_GenerateSTOP(I2C2, ENABLE);
  
  /* If operation is OK, return 0 */
  return 0;
}

/**
  * @brief  Reads a byte from a specific Camera register
  * @param  Addr: OV5640 register address.
  * @retval data read from the specific register or 0xFF if timeout condition
  *         occured. 
  */

uint8_t OV5640_ReadReg(uint16_t Addr)
{
  uint32_t timeout = DCMI_TIMEOUT_MAX;
  uint8_t Data = 0;

  /* Generate the Start Condition */
  I2C_GenerateSTART(I2C2, ENABLE);

  /* Test on I2C1 EV5 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_MODE_SELECT))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  } 
  
  /* Send DCMI selcted device slave Address for write */
  I2C_Send7bitAddress(I2C2, OV5640_DEVICE_READ_ADDRESS, I2C_Direction_Transmitter);
 
  /* Test on I2C2 EV6 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  } 

  /* Send I2C1 location address LSB */
  I2C_SendData(I2C2, (uint8_t)(Addr));

  /* Test on I2C1 EV8 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  } 
  
  /* Clear AF flag if arised */
  I2C1->SR1 |= (uint16_t)0x0400;

  /* Generate the Start Condition */
  I2C_GenerateSTART(I2C2, ENABLE);
  
  /* Test on I2C1 EV6 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_MODE_SELECT))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  } 
  
  /* Send DCMI selcted device slave Address for write */
  I2C_Send7bitAddress(I2C2, OV5640_DEVICE_READ_ADDRESS, I2C_Direction_Receiver);
   
  /* Test on I2C1 EV6 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  }  
 
  /* Prepare an NACK for the next data received */
  I2C_AcknowledgeConfig(I2C2, DISABLE);

  /* Test on I2C2 EV7 and clear it */
  timeout = DCMI_TIMEOUT_MAX; /* Initialize timeout value */
  while(!I2C_CheckEvent(I2C2, I2C_EVENT_MASTER_BYTE_RECEIVED))
  {
    /* If the timeout delay is exeeded, exit with error code */
    if ((timeout--) == 0) return 0xFF;
  }   
    
  /* Prepare Stop after receiving data */
  I2C_GenerateSTOP(I2C2, ENABLE);

  /* Receive the Data */
  Data = I2C_ReceiveData(I2C2);

  /* return the read data */
  return Data;
}


/************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/
